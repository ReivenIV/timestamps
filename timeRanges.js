const outputQuery = [
  {
    user_id: 5,
    tremor_id: 9037,
    arm: "R",
    score: 3.0139105319976807,
    date: "2022-10-15 08:56:27",
  },
  {
    user_id: 5,
    tremor_id: 9036,
    arm: "L",
    score: 2.4148945808410645,
    date: "2022-10-15 08:56:26",
  },
  {
    user_id: 5,
    tremor_id: 9015,
    arm: "R",
    score: 3.724491834640503,
    date: "2022-10-03 05:53:03",
  },
  {
    user_id: 5,
    tremor_id: 9014,
    arm: "L",
    score: 3.022581100463867,
    date: "2022-10-03 05:53:01",
  },
  {
    user_id: 5,
    tremor_id: 9005,
    arm: "R",
    score: 2.6499602794647217,
    date: "2022-10-02 12:02:27",
  },
  {
    user_id: 5,
    tremor_id: 9004,
    arm: "L",
    score: 2.4708094596862793,
    date: "2022-10-02 12:02:26",
  },
  {
    user_id: 5,
    tremor_id: 9003,
    arm: "R",
    score: 2.587585687637329,
    date: "2022-10-02 06:38:31",
  },
  {
    user_id: 5,
    tremor_id: 9002,
    arm: "L",
    score: 2.4541993141174316,
    date: "2022-10-02 06:38:29",
  },
  {
    user_id: 5,
    tremor_id: 9001,
    arm: "R",
    score: 3.5798072814941406,
    date: "2022-10-01 05:48:42",
  },
  {
    user_id: 5,
    tremor_id: 9000,
    arm: "L",
    score: 3.6953606605529785,
    date: "2022-10-01 05:48:40",
  },
  {
    user_id: 5,
    tremor_id: 8999,
    arm: "R",
    score: 3.0195095539093018,
    date: "2022-10-01 05:18:14",
  },
  {
    user_id: 5,
    tremor_id: 8998,
    arm: "L",
    score: 3.6839993000030518,
    date: "2022-10-01 05:18:12",
  },
  {
    user_id: 5,
    tremor_id: 8997,
    arm: "R",
    score: 2.417694568634033,
    date: "2022-09-30 11:24:55",
  },
  {
    user_id: 5,
    tremor_id: 8996,
    arm: "L",
    score: 2.6973540782928467,
    date: "2022-09-30 11:24:54",
  },
  {
    user_id: 5,
    tremor_id: 8989,
    arm: "R",
    score: 3.6921584606170654,
    date: "2022-09-30 07:28:45",
  },
  {
    user_id: 5,
    tremor_id: 8988,
    arm: "L",
    score: 3.6810481548309326,
    date: "2022-09-30 07:28:44",
  },
  {
    user_id: 5,
    tremor_id: 8981,
    arm: "R",
    score: 3.8610353469848633,
    date: "2022-09-29 15:08:30",
  },
  {
    user_id: 5,
    tremor_id: 8980,
    arm: "L",
    score: 3.4747471809387207,
    date: "2022-09-29 15:08:29",
  },
  {
    user_id: 5,
    tremor_id: 8979,
    arm: "R",
    score: 3.5918023586273193,
    date: "2022-09-29 15:01:41",
  },
  {
    user_id: 5,
    tremor_id: 8978,
    arm: "L",
    score: 2.8146615028381348,
    date: "2022-09-29 15:01:39",
  },
  {
    user_id: 5,
    tremor_id: 8957,
    arm: "R",
    score: 3.3115744590759277,
    date: "2022-09-25 14:19:24",
  },
  {
    user_id: 5,
    tremor_id: 8956,
    arm: "L",
    score: 3.509648323059082,
    date: "2022-09-25 14:19:22",
  },
  {
    user_id: 5,
    tremor_id: 8955,
    arm: "R",
    score: 2.43295955657959,
    date: "2022-09-25 10:21:45",
  },
  {
    user_id: 5,
    tremor_id: 8954,
    arm: "L",
    score: 2.564181089401245,
    date: "2022-09-25 10:21:43",
  },
  {
    user_id: 5,
    tremor_id: 8953,
    arm: "R",
    score: 3.37351655960083,
    date: "2022-09-24 20:15:48",
  },
  {
    user_id: 5,
    tremor_id: 8952,
    arm: "L",
    score: 3.648955821990967,
    date: "2022-09-24 20:15:47",
  },
  {
    user_id: 5,
    tremor_id: 8951,
    arm: "R",
    score: 3.7687485218048096,
    date: "2022-09-24 20:15:12",
  },
  {
    user_id: 5,
    tremor_id: 8950,
    arm: "L",
    score: 3.646838665008545,
    date: "2022-09-24 20:15:11",
  },
  {
    user_id: 5,
    tremor_id: 8949,
    arm: "R",
    score: 2.8677332401275635,
    date: "2022-09-24 18:42:14",
  },
  {
    user_id: 5,
    tremor_id: 8948,
    arm: "L",
    score: 3.2412004470825195,
    date: "2022-09-24 18:42:12",
  },
  {
    user_id: 5,
    tremor_id: 8947,
    arm: "R",
    score: 3.0247888565063477,
    date: "2022-09-24 17:51:01",
  },
  {
    user_id: 5,
    tremor_id: 8946,
    arm: "L",
    score: 3.481454610824585,
    date: "2022-09-24 17:51:00",
  },
  {
    user_id: 5,
    tremor_id: 8925,
    arm: "R",
    score: 3.1006920337677,
    date: "2022-09-22 09:09:15",
  },
  {
    user_id: 5,
    tremor_id: 8924,
    arm: "L",
    score: 3.7751214504241943,
    date: "2022-09-22 09:09:14",
  },
  {
    user_id: 5,
    tremor_id: 8923,
    arm: "R",
    score: 1.9695193767547607,
    date: "2022-09-22 07:43:00",
  },
  {
    user_id: 5,
    tremor_id: 8922,
    arm: "L",
    score: 2.6357579231262207,
    date: "2022-09-22 07:42:59",
  },
  {
    user_id: 5,
    tremor_id: 8921,
    arm: "R",
    score: 2.566873073577881,
    date: "2022-09-22 06:41:22",
  },
  {
    user_id: 5,
    tremor_id: 8920,
    arm: "L",
    score: 3.7120437622070312,
    date: "2022-09-22 06:41:21",
  },
  {
    user_id: 5,
    tremor_id: 8919,
    arm: "R",
    score: 3.1282289028167725,
    date: "2022-09-22 05:58:37",
  },
  {
    user_id: 5,
    tremor_id: 8918,
    arm: "L",
    score: 3.829394817352295,
    date: "2022-09-22 05:58:35",
  },
  {
    user_id: 5,
    tremor_id: 8917,
    arm: "R",
    score: 3.723665714263916,
    date: "2022-09-21 17:23:49",
  },
  {
    user_id: 5,
    tremor_id: 8916,
    arm: "L",
    score: 3.686338186264038,
    date: "2022-09-21 17:23:48",
  },
  {
    user_id: 5,
    tremor_id: 8915,
    arm: "R",
    score: 3.863893508911133,
    date: "2022-09-21 16:21:47",
  },
  {
    user_id: 5,
    tremor_id: 8914,
    arm: "L",
    score: 3.38765287399292,
    date: "2022-09-21 16:21:45",
  },
  {
    user_id: 5,
    tremor_id: 8913,
    arm: "R",
    score: 3.4028074741363525,
    date: "2022-09-21 14:18:32",
  },
  {
    user_id: 5,
    tremor_id: 8912,
    arm: "L",
    score: 3.3911490440368652,
    date: "2022-09-21 14:18:31",
  },
  {
    user_id: 5,
    tremor_id: 8907,
    arm: "R",
    score: 2.559417724609375,
    date: "2022-09-21 12:34:29",
  },
  {
    user_id: 5,
    tremor_id: 8906,
    arm: "L",
    score: 2.805121660232544,
    date: "2022-09-21 12:34:28",
  },
  {
    user_id: 5,
    tremor_id: 8905,
    arm: "R",
    score: 3.6524384021759033,
    date: "2022-09-21 12:23:33",
  },
  {
    user_id: 5,
    tremor_id: 8904,
    arm: "L",
    score: 3.265040159225464,
    date: "2022-09-21 12:23:32",
  },
  {
    user_id: 5,
    tremor_id: 8903,
    arm: "R",
    score: 3.837202548980713,
    date: "2022-09-21 11:45:25",
  },
  {
    user_id: 5,
    tremor_id: 8902,
    arm: "L",
    score: 3.460218667984009,
    date: "2022-09-21 11:45:23",
  },
  {
    user_id: 5,
    tremor_id: 8901,
    arm: "R",
    score: 1.6545771360397339,
    date: "2022-09-21 08:52:00",
  },
  {
    user_id: 5,
    tremor_id: 8900,
    arm: "L",
    score: 3.693768262863159,
    date: "2022-09-21 08:51:58",
  },
  {
    user_id: 5,
    tremor_id: 8899,
    arm: "R",
    score: 3.7581756114959717,
    date: "2022-09-21 08:13:30",
  },
  {
    user_id: 5,
    tremor_id: 8898,
    arm: "L",
    score: 2.7697479724884033,
    date: "2022-09-21 08:13:29",
  },
];



const booleanRanger = [[], []];

outputQuery.forEach((row) => {
  if (row.arm === "L") booleanRanger[0].push(row);
  if (row.arm === "R") booleanRanger[1].push(row);
});

//console.log(booleanRanger);

const ranges = [
  { name: "0h", start: "00:00", end: "06:29" },
  { name: "8h", start: "06:00", end: "09:29" },
  { name: "11h", start: "09:30", end: "12:29" },
  { name: "14h", start: "12:30", end: "15:29" },
  { name: "17h", start: "15:30", end: "18:29" },
  { name: "20h", start: "18:30", end: "23:29" },
];

const groupByTimeRange = booleanRanger[0].reduce((acc, cur) => {
  const time = cur.date.slice(0, -8); // many ways to skin a cat
 // console.log(time);
  const range = ranges.find(
    (range) => time >= range.start && time <= range.end
  ); // find returns the first found
  const name = range.name;
  (acc[name] = acc[name] || []).push(cur); // (if there, reuse, otherwise create) then push
  return acc;
}, {});

//console.log(groupByTimeRange);

const results = Object.entries(groupByTimeRange).map(([key, val]) => {
  const sum = val.reduce((a, b) => {
    return a + b.score;
  }, 0);
  const avg = Math.round(sum / val.length);
  return { timeRange: key, AverageScore: avg };
});

//console.log(results);